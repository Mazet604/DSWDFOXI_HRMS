import{a_ as o,bU as $,bF as F,aL as L,I as M,o as a,c as r,b as t,X as c,bo as m,d as x,t as b,M as T,bO as R,F as U,r as j,bK as I,n as Y,bV as q,L as z}from"./app-CcJmYwvh.js";import{_ as A,a as X}from"./InputError-BrOiQ69D.js";import{P as k}from"./PrimaryButton-BBcgw-4e.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const K={class:"fixed inset-0 flex items-center justify-center z-50"},Q={class:"relative bg-white rounded-lg shadow-lg p-6 w-full max-w-lg"},W={key:0,class:"w-full p-6 bg-white rounded-lg shadow-md sm:p-8 lg:p-10 border border-gray-300"},Z={key:0,class:"mb-4 text-sm font-medium text-green-600"},G={key:1,class:"mb-4 text-sm font-medium text-red-600"},J={class:"mt-6 text-center"},ee={class:"flex justify-center mt-2 space-x-3"},te={class:"mb-4 mt-5 text-center text-red-500"},se={class:"flex justify-center mt-8"},oe={key:1,class:"w-full p-6 bg-white rounded-lg shadow-md sm:p-8 lg:p-10"},le={class:"flex justify-center"},ae={__name:"ChangePass",props:{context:{type:String,required:!0},otpSent:{type:Boolean,default:!1}},setup(E){const O=E,l=o(["","","","","",""]),i=o(null),g=o(null),y=o(!1),p=o(!1),h=o(!1),w=o(O.context),n=o(300),_=o(null),u=$({otp:"",context:w.value}),P=()=>{_.value=setInterval(()=>{n.value>0?n.value--:(clearInterval(_.value),p.value=!0)},1e3)},V=()=>{h.value||(i.value=null,h.value=!0)},C=()=>{u.post(route("otp.resend"),{onSuccess:s=>{p.value=!1,y.value=!1,n.value=300,P()},onError:s=>{i.value="Failed to resend OTP. Please try again."}})},D=(s,e)=>{const f=s.target.value;/^\d$/.test(f)?(l.value[e]=f,e<l.value.length-1&&document.getElementById("otp"+(e+1)).focus()):l.value[e]=""},B=s=>{const e=(s.clipboardData||window.clipboardData).getData("text");/^\d{6}$/.test(e)&&(l.value=e.split(""),s.preventDefault())};F(w,s=>{u.context=s}),L(()=>{P()});const N=M(()=>{const s=Math.floor(n.value/60),e=n.value%60;return`${s}:${e<10?"0":""}${e}`}),S=()=>{emit("close")};return(s,e)=>(a(),r("div",K,[e[8]||(e[8]=t("div",{class:"fixed inset-0 bg-black opacity-50"},null,-1)),t("div",Q,[t("button",{onClick:S,class:"absolute top-2 right-2 text-gray-500 hover:text-gray-700"}," × "),c(m(q),{title:"OTP Verification"}),!p.value&&!y.value?(a(),r("div",W,[e[2]||(e[2]=t("div",{class:"mb-6 text-2xl font-semibold text-center lg:text-3xl text-red-600"},"AUTHENTICATION REQUIRED",-1)),e[3]||(e[3]=t("p",{class:"mb-8 text-center text-gray-500 text-md"},[x("Your OTP code was sent to your email "),t("span",{class:"text-black text-2xl"},"✉")],-1)),e[4]||(e[4]=t("hr",{class:"mb-16 border-gray-300"},null,-1)),g.value?(a(),r("div",Z,b(g.value),1)):T("",!0),i.value?(a(),r("div",G,b(i.value),1)):T("",!0),t("form",{onSubmit:R(V,["prevent"])},[t("div",J,[t("div",ee,[(a(!0),r(U,null,j(l.value,(f,d)=>(a(),z(X,{key:d,id:"otp"+d,type:"text",class:"text-2xl text-center border border-gray-300 rounded-lg w-14 h-14 focus:outline-none focus:ring-2 focus:ring-blue-500",modelValue:l.value[d],"onUpdate:modelValue":v=>l.value[d]=v,maxlength:"1",onInput:v=>D(v,d),onPaste:B,required:""},null,8,["id","modelValue","onUpdate:modelValue","onInput"]))),128))]),c(A,{class:"mt-2",message:m(u).errors.otp},null,8,["message"])]),t("div",te,[e[0]||(e[0]=x(" OTP WILL EXPIRE: ")),t("strong",null,b(N.value),1)]),t("div",se,[c(k,{class:Y([{"opacity-50":m(u).processing},"py-3 px-8 text-center text-white bg-gradient-to-r from-blue-900 to-blue-900 rounded-full hover:from-blue-800 hover:to-blue-800"]),disabled:m(u).processing},{default:I(()=>e[1]||(e[1]=[t("span",{class:"w-full text-center"},"VERIFY OTP",-1)])),_:1},8,["class","disabled"])])],32)])):(a(),r("div",oe,[e[6]||(e[6]=t("div",{class:"mb-6 text-2xl font-semibold text-center lg:text-3xl"},"OTP Expired",-1)),e[7]||(e[7]=t("p",{class:"mb-8 text-center font-semibold text-gray-500"},"Your OTP has expired. Please click the button below to resend a new OTP.",-1)),t("div",le,[c(k,{onClick:C,class:"py-3 px-8 text-center text-white bg-gradient-to-r from-blue-900 to-blue-900 rounded-full hover:from-blue-800 hover:to-blue-800"},{default:I(()=>e[5]||(e[5]=[x(" RESEND OTP ")])),_:1})])]))])]))}},ie=H(ae,[["__scopeId","data-v-b4164f26"]]);export{ie as default};
