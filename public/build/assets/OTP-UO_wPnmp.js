import{a_ as l,bU as $,bF as j,aL as F,I as L,o as r,c as i,X as f,bo as v,b as t,d as w,t as y,M as O,bO as U,F as I,r as M,bK as k,n as Y,bV as q,L as A}from"./app-D8ApERZR.js";import{_ as X,a as z}from"./InputError-BDigjo80.js";import{P as E}from"./PrimaryButton-DIljoyl6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"flex items-center justify-center min-h-screen bg-center bg-cover",style:{"background-image":"url('/images/backgrounddswd.png')"}},K={key:0,class:"w-full max-w-lg p-6 bg-white rounded-lg shadow-md sm:p-8 lg:p-10 sm:max-w-xl lg:max-w-2xl border border-gray-300"},Q={key:0,class:"mb-4 text-sm font-medium text-green-600"},W={key:1,class:"mb-4 text-sm font-medium text-red-600"},Z={class:"mt-6 text-center"},G={class:"flex justify-center mt-2 space-x-3"},J={class:"mb-4 mt-5 text-center text-red-500"},ee={class:"flex justify-center mt-8"},te={key:1,class:"w-full max-w-lg p-6 bg-white rounded-lg shadow-md sm:p-8 lg:p-10 sm:max-w-xl lg:max-w-2xl"},se={key:2,class:"w-full max-w-lg p-6 bg-white rounded-lg shadow-md sm:p-8 lg:p-10 sm:max-w-xl lg:max-w-2xl"},le={class:"flex justify-center"},ue={__name:"OTP",props:{context:{type:String,required:!0},otpSent:{type:Boolean,default:!1}},setup(V){const D=V,o=l(["","","","","",""]),d=l(null),P=l(null),n=l(!1),x=l(!1),p=l(!1),u=l(D.context),c=l(300),h=l(null),a=$({otp:"",context:u.value}),T=()=>{h.value=setInterval(()=>{c.value>0?c.value--:(clearInterval(h.value),x.value=!0)},1e3)},S=()=>{p.value||(d.value=null,p.value=!0,u.value==="forgot-password"?(n.value=!0,setTimeout(()=>{_()},5e3)):u.value==="login"&&_())},_=()=>{a.otp=o.value.join(""),a.context=u.value,a.post(route("otp.verify"),{onError:s=>{d.value="Invalid OTP. Please try again.",n.value=!1,p.value=!1},onSuccess:s=>{s.props.success?u.value==="forgot-password"&&s.props.passwordReset?n.value=!0:u.value==="login"&&(window.location.href=route("dashboard").url()):(d.value="Invalid OTP. Please try again.",n.value=!1,p.value=!1)}})},B=()=>{a.post(route("otp.resend"),{onSuccess:s=>{x.value=!1,n.value=!1,c.value=300,T()},onError:s=>{d.value="Failed to resend OTP. Please try again."}})},C=(s,e)=>{const g=s.target.value;/^\d$/.test(g)?(o.value[e]=g,e<o.value.length-1&&document.getElementById("otp"+(e+1)).focus()):o.value[e]=""},N=s=>{const e=(s.clipboardData||window.clipboardData).getData("text");/^\d{6}$/.test(e)&&(o.value=e.split(""),s.preventDefault())};j(u,s=>{a.context=s}),F(()=>{T()});const R=L(()=>{const s=Math.floor(c.value/60),e=c.value%60;return`${s}:${e<10?"0":""}${e}`});return(s,e)=>(r(),i(I,null,[f(v(q),{title:"OTP Verification"}),t("div",H,[!x.value&&!n.value?(r(),i("div",K,[e[2]||(e[2]=t("div",{class:"mb-6 text-2xl font-semibold text-center lg:text-3xl text-red-600"},"AUTHENTICATION REQUIRED",-1)),e[3]||(e[3]=t("p",{class:"mb-8 text-center text-gray-500 text-md"},[w("Your OTP code was sent to your email "),t("span",{class:"text-black text-2xl"},"âœ‰")],-1)),e[4]||(e[4]=t("hr",{class:"mb-16 border-gray-300"},null,-1)),P.value?(r(),i("div",Q,y(P.value),1)):O("",!0),d.value?(r(),i("div",W,y(d.value),1)):O("",!0),t("form",{onSubmit:U(S,["prevent"])},[t("div",Z,[t("div",G,[(r(!0),i(I,null,M(o.value,(g,m)=>(r(),A(z,{key:m,id:"otp"+m,type:"text",class:"text-2xl text-center border border-gray-300 rounded-lg w-14 h-14 focus:outline-none focus:ring-2 focus:ring-blue-500",modelValue:o.value[m],"onUpdate:modelValue":b=>o.value[m]=b,maxlength:"1",onInput:b=>C(b,m),onPaste:N,required:""},null,8,["id","modelValue","onUpdate:modelValue","onInput"]))),128))]),f(X,{class:"mt-2",message:v(a).errors.otp},null,8,["message"])]),t("div",J,[e[0]||(e[0]=w(" OTP WILL EXPIRE: ")),t("strong",null,y(R.value),1)]),t("div",ee,[f(E,{class:Y([{"opacity-50":v(a).processing},"py-3 px-8 text-center text-white bg-gradient-to-r from-blue-900 to-blue-900 rounded-full hover:from-blue-800 hover:to-blue-800"]),disabled:v(a).processing},{default:k(()=>e[1]||(e[1]=[t("span",{class:"w-full text-center"},"VERIFY OTP",-1)])),_:1},8,["class","disabled"])])],32)])):n.value?(r(),i("div",te,e[5]||(e[5]=[t("div",{class:"mb-6 text-2xl font-semibold text-center lg:text-3xl"},"Password Reset Verification",-1),t("p",{class:"mb-8 text-center text-gray-500"},"Please wait... ",-1)]))):(r(),i("div",se,[e[7]||(e[7]=t("div",{class:"mb-6 text-2xl font-semibold text-center lg:text-3xl"},"OTP Expired",-1)),e[8]||(e[8]=t("p",{class:"mb-8 text-center font-semibold text-gray-500"},"Your OTP has expired. Please click the button below to resend a new OTP.",-1)),t("div",le,[f(E,{onClick:B,class:"py-3 px-8 text-center text-white bg-gradient-to-r from-blue-900 to-blue-900 rounded-full hover:from-blue-800 hover:to-blue-800"},{default:k(()=>e[6]||(e[6]=[w(" RESEND OTP ")])),_:1})])]))])],64))}};export{ue as default};
